package com.symphony.malware.scan.metrics;

import com.codahale.metrics.Meter;
import com.codahale.metrics.Timer;

/**
 * Defines the contract for Malware Scanning metrics.
 *
 * @author Andrey Zavizionov on 2020-01-22
 */
public interface MalwareScanningMetrics {
  /**
   * @return meter for the successfully submitted requests count.
   */
  Meter countOfSuccessfulRequests();

  /**
   * @return meter for the count of requests that failed to be submitted.
   */
  Meter countOfFailedToSubmitRequests();

  /**
   * @return meter for the count of requests that failed to be submitter and
   * were successfully submitted after retry.
   */
  Meter countOfSuccessfulOnRetryRequests();

  /**
   * @return meter for the count of requests that failed to be submitted
   * after exhausting the retry limit.
   */
  Meter countOfFailedToSubmitAfterRetryExhaustedRequest();

  /**
   * @return timer to track time between the initial submission fail
   * and following successful submission.
   */
  Timer timeBetweenInitialFailedRequestAndSuccessfulRetry();

  /**
   * @return timer to track time between the request submission to Symproxy
   * and receiving response from Symproxy
   */
  Timer timeBetweenSubmittingRequestAndGettingResponseFromSymproxy();

  /**
   * @return timer to track time between the request submission to Symproxy
   * and receiving scanning response from Malware Scanner
   */
  Timer timeBetweenSubmittingRequestAndGettingResponseFromScanner();
}

