package com.symphony.malware.scan.metrics;

import com.codahale.metrics.JmxReporter;
import com.codahale.metrics.MetricRegistry;
import com.codahale.metrics.Reporter;
import lombok.extern.slf4j.Slf4j;

/**
 * Reports Malware Scanning metrics.
 * @author Andrey Zavizionov on 2020-01-28
 */
@Slf4j
public class MalwareScanningMetricReport {
  private final MetricRegistry registry;
  private Reporter reporter;

  public MalwareScanningMetricReport() {
    this.registry = new MetricRegistry();
    startReport();
  }

  void startReport() {
    reporter = JmxReporter.forRegistry(registry).build();
    ((JmxReporter) reporter).start();
  }

  public MetricRegistry getRegistry() {
    return registry;
  }

  public Reporter getReporter() {
    return reporter;
  }
}
