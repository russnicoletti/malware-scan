package com.symphony.malware.scan.processor;

import com.symphony.malware.scan.model.MalwareScanRequestDto;
import com.symphony.malware.scan.model.MalwareScanResponseDto;
import com.symphony.malware.scan.persistence.exception.MalwareScanException;
import com.symphony.malware.scan.service.MalwareScanValidationService;

import lombok.extern.slf4j.Slf4j;

/**
 * Validates malware scan request
 */
@Slf4j
public class ValidateMalwareScanProcessor implements Processor<MalwareScanRequestDto, MalwareScanResponseDto> {

    private final MalwareScanValidationService malwareScanValidationService;

    public ValidateMalwareScanProcessor(
        final MalwareScanValidationService malwareScanValidationService

    ) {
        this.malwareScanValidationService = malwareScanValidationService;
    }

    @Override
    public MalwareScanResponseDto process(final MalwareScanRequestDto malwareScanRequestDto) throws MalwareScanException {
        LOGGER.info("Validate malware scan request {}", malwareScanRequestDto);
        return malwareScanValidationService.validate(malwareScanRequestDto).toBuilder().malwareScanRequestDto(malwareScanRequestDto).build();
    }

}
