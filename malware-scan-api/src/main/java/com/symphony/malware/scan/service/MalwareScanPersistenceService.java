package com.symphony.malware.scan.service;

import com.symphony.malware.scan.model.AttachmentMetaDto;
import com.symphony.malware.scan.model.MalwareScanPersistenceResponse;
import com.symphony.malware.scan.model.MalwareScanRequestDto;

public interface MalwareScanPersistenceService {

    /**
     * Creates initial entries in malware scan state and malware scan mapping tables
     * Initially we store malware scan state in PENDING status
     * @param malwareScanRequestDto malware scan request
     * @param attachmentMetaDto attachment meta
     * @return object which indicates whether information was stored successfully
     */
    MalwareScanPersistenceResponse create(
        final MalwareScanRequestDto malwareScanRequestDto,
        final AttachmentMetaDto attachmentMetaDto
    );

    /**
     * Updates entry in the malware scan state table with the result of RLP call
     * @param malwareScanRequestDto malware scan request
     * @param attachmentMetaDto attachment meta
     * @return object which indicates whether information was stored successfully
     */
    MalwareScanPersistenceResponse update(
        final MalwareScanRequestDto malwareScanRequestDto,
        final AttachmentMetaDto attachmentMetaDto
    );
}
