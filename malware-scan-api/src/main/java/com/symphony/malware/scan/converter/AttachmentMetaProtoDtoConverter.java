package com.symphony.malware.scan.converter;

import com.symphony.malware.scan.AttachmentData;
import com.symphony.malware.scan.model.AttachmentMetaDto;

import java.util.Optional;

public class AttachmentMetaProtoDtoConverter implements ProtoDtoConverter<AttachmentData.AttachmentMeta, AttachmentMetaDto> {

    @Override
    public AttachmentMetaDto toDto(final AttachmentData.AttachmentMeta attachmentMeta) {
        return Optional.ofNullable(attachmentMeta)
            .map(msr -> AttachmentMetaDto.builder()
                .name(attachmentMeta.getName())
                .fileId(attachmentMeta.getFileId())
                .contentType(attachmentMeta.getContentType())
                .creatorId(attachmentMeta.getCreatorId())
                .sizeInBytes(attachmentMeta.getSizeInBytes())
                .build())
            .orElse(null);
    }

    @Override
    public AttachmentData.AttachmentMeta toProto(final AttachmentMetaDto attachmentMetaDto) {
        return Optional.ofNullable(attachmentMetaDto)
            .map(msrd -> {
                final AttachmentData.AttachmentMeta.Builder attachmentMetaBuilder = AttachmentData.AttachmentMeta.newBuilder()
                    .setName(attachmentMetaDto.getName())
                    .setFileId(attachmentMetaDto.getFileId())
                    .setContentType(attachmentMetaDto.getContentType())
                    .setSizeInBytes(attachmentMetaDto.getSizeInBytes());

                if (attachmentMetaDto.getCreatorId() != null) {
                    attachmentMetaBuilder.setCreatorId(attachmentMetaDto.getCreatorId());
                }

                return attachmentMetaBuilder.build();
            })
            .orElse(null);
    }

}
