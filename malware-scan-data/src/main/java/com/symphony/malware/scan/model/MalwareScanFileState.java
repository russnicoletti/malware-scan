package com.symphony.malware.scan.model;

import lombok.Builder;
import lombok.Getter;
import lombok.ToString;

import java.time.Instant;

/**
 * Malware scan file state object, which is stored to the database
 * Represents a malware scan state of the file
 */
@Getter
@Builder(toBuilder = true)
@ToString
public class MalwareScanFileState {

  private String fileId;

  private Status status;

  private Long ttl;

  private Instant createTimestamp;

  /**
   * The {@link Actor} who created the entry
   */
  private Actor createdBy;

  private Instant lastUpdateTimestamp;

  /**
   * The {@link Actor} who updated the entry last
   */
  private Actor lastUpdatedBy;

  private Instant lastRetryTimestamp;

  private Long sizeInBytes;

  private String contentType;

  private String fileName;

  private String creatorId;

  private String originalStreamId;

  private String originalMessageId;

  /**
   * Details which could be provided by Malware Scanner, keeping it as a string as we are not aware of its structure
   */
  private String details;

  private Long numberOfRetries;


  public enum Status {
    PENDING, SUBMITTED, OK, BAD, UNSCANNABLE, EXPIRED, FAILED_SUBMIT, FAILED_RETRY, OK_DISABLED;
  }

}
