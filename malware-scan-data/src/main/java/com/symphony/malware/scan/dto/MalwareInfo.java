package com.symphony.malware.scan.dto;

import lombok.Data;
import lombok.experimental.Accessors;

import java.time.Instant;

@Data
@Accessors(chain = true)
public class MalwareInfo {

  private String fileId;

  private Status status;

  private Long ttl;

  private Instant createTimestamp;

  private String createdBy;

  private Instant lastUpdateTimestamp;

  private String lastUpdatedBy;

  private Instant lastRetryTimestamp;

  private Long sizeInBytes;

  private String contentType;

  /**
   * TODO There is a discussion about encrypting file name
   */
  private String fileName;

  private Long creatorId;

  private String originalMessageId;

  private String originalStreamId;

  /**
   * Details which could be provided by Malware Scanner, keeping it as a string as we are not aware of its structure
   */
  private String details;

  private Long numberOfRetries;


  private enum Status {
    PENDING, SUBMITTED, OK, BAD, UNSCANNABLE, EXPIRED, FAILED_SUBMIT, FAILED_RETRY, OK_DISABLED;
  }

}
