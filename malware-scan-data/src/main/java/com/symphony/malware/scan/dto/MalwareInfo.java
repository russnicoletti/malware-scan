package com.symphony.malware.scan.dto;

import lombok.Data;
import lombok.experimental.Accessors;

import java.time.Instant;

@Data
@Accessors(chain = true)
public class MalwareInfo {

  private Status status;

  private Long ttl;

  private String messageId;

  /**
   * Same as a thread id
   */
  private String streamId;

  private String streamName;

  private String streamType;

  private Long sendingPod;

  private Instant createTimestamp;

  private String createdBy;

  private Instant lastUpdateTimestamp;

  private String lastUpdatedBy;

  private Instant lastRetryTimestamp;

  /**
   * This is an existing structure, should reflect the structure of existing protobuf
   */
  private AttachmentMeta attachmentMeta;

  private Sender sender;

  /**
   * Details which could be provided by Malware Scanner, keeping it as a string as we are not aware of its structure
   */
  private String details;
  private Long numberOfRetries;


  private enum Status {
    OK, BAD, PENDING, SUBMITTED, FAILED, EXPIRED, UNSCANNABLE;
  }

}
